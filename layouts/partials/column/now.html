{{/* Now 列模板 */}}
{{ range .pages }}
<article class="deck-card now-card{{ with .Params.type }} now-card--{{ . }}{{ end }}">
    <time class="now-card__time" datetime="{{ .Date.Format " 2006-01-02" }}">
        {{ .Date.Format "Jan 2" }}
    </time>

    <div class="now-card__content">
        <h3 class="now-card__title">
            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
        </h3>

        {{ $coverImage := "" }}
        {{ if .Params.cover }}
        {{ $coverImage = .Params.cover | absURL }}
        {{ else if .Resources }}
        {{ $images := .Resources.Match "*.{jpg,jpeg,png,gif}" }}
        {{ if $images }}
        {{ $coverImage = (index $images 0).RelPermalink }}
        {{ end }}
        {{ end }}

        {{ if not $coverImage }}
        {{ $imgRegex := `<img[^>]+src="([^"]+)"` }}
            {{ $matches := findRE $imgRegex .Content 1 }}
            {{ if $matches }}
            {{ $coverImage = replaceRE $imgRegex "$1" (index $matches 0) }}
            {{ end }}
            {{ end }}

            {{ if $coverImage }}
            <div class="now-card__image">
                <img src="{{ $coverImage }}" alt="{{ .Title }}">
            </div>
            {{ end }}

            {{ with .Params.tags }}
            <div class="now-card__tags">
                {{ range . }}
                <span class="now-card__tag">{{ . }}</span>
                {{ end }}
            </div>
            {{ end }}
    </div>
</article>
{{ end }}